<script setup lang="ts">
import { ref, type Ref } from 'vue';
import type { VulnerabilityDetails } from '@/codeclarity_components/results/vulnerabilities/VulnDetails/VulnDetails';
import { getRadarChartConfig as getCVSSRadarChartConfig } from '../cvssChart';
import {
    getRadarChartConfig as getImpactRadarChartConfig,
    getContinousFromDiscreteCVSS2,
    getContinousFromDiscreteCVSS3
} from '../impactChart';
import { Radar } from 'vue-chartjs';
import { Chart, registerables } from 'chart.js';
import { Icon } from '@iconify/vue';

Chart.register(...registerables);

const props = defineProps<{
    finding: VulnerabilityDetails;
    cvssV3FieldsMap: {
        [key: string]: any;
        attack_vector: {
            full_name: string;
            values: string[];
            text: {
                description: string;
                value_descriptions: { P: string; L: string; A: string; N: string };
            };
            class: { P: string; L: string; A: string; N: string };
            value_map: { P: string; L: string; A: string; N: string };
        };
        attack_complexity: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { H: string; L: string } };
            class: { H: string; L: string };
            value_map: { H: string; L: string };
        };
        confidentiality_impact: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { H: string; L: string; N: string } };
            class: { N: string; L: string; H: string };
            value_map: { N: string; L: string; H: string };
        };
        integrity_impact: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { H: string; L: string; N: string } };
            class: { N: string; L: string; H: string };
            value_map: { N: string; L: string; H: string };
        };
        availability_impact: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { H: string; L: string; N: string } };
            class: { N: string; L: string; H: string };
            value_map: { N: string; L: string; H: string };
        };
        user_interaction: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { N: string; R: string } };
            class: { R: string; N: string };
            value_map: { R: string; N: string };
        };
        privileges_required: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { N: string; H: string; L: string } };
            class: { H: string; L: string; N: string };
            value_map: { H: string; L: string; N: string };
        };
        scope: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { U: string; C: string } };
            class: { U: string; C: string };
            value_map: { U: string; C: string };
        };
    };
    cvssV2FieldsMap: {
        [key: string]: any;
        access_vector: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { L: string; A: string; N: string } };
            class: { L: string; A: string; N: string };
            value_map: { L: string; A: string; N: string };
        };
        access_complexity: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { H: string; M: string; L: string } };
            class: { H: string; M: string; L: string };
            value_map: { H: string; M: string; L: string };
        };
        confidentiality_impact: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { N: string; P: string; C: string } };
            class: { N: string; P: string; C: string };
            value_map: { N: string; P: string; C: string };
        };
        integrity_impact: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { N: string; P: string; C: string } };
            class: { N: string; P: string; C: string };
            value_map: { N: string; P: string; C: string };
        };
        availability_impact: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { N: string; P: string; C: string } };
            class: { N: string; P: string; C: string };
            value_map: { N: string; P: string; C: string };
        };
        authentication: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { M: string; S: string; N: string } };
            class: { M: string; S: string; N: string };
            value_map: { M: string; S: string; N: string };
        };
        urser_interaction_required: {
            full_name: string;
            values: string[];
            text: { description: string; value_descriptions: { T: string; F: string } };
            class: { T: string; F: string };
            value_map: { T: string; F: string };
        };
    };
    chartVersion: any;
    cvssChartData: any;
    impactChartData: any;
    cvssFieldInfoModalRef: any;
}>();

const emit = defineEmits<{
    (e: 'openModal', data: object): void;
}>();

const cvss_field: Ref<string> = ref('');
const cvss_field_value: Ref<string> = ref('');
const cvss_field_version: Ref<string> = ref('');
const cvss_info: Ref<object> = ref({});

function openCVSSFieldValueDetailsModal(
    _cvss_field: string,
    _cvss_field_value: string,
    _cvss_version: string
) {
    cvss_field.value = _cvss_field;
    cvss_field_value.value = _cvss_field_value;
    cvss_field_version.value = _cvss_version;
    // props.cvss_field_info_modal_ref.show();
    if (cvss_field_version.value == '2') {
        cvss_info.value = props.cvssV2FieldsMap;
    }
    if (cvss_field_version.value == '3') {
        cvss_info.value = props.cvssV3FieldsMap;
    }
    emit('openModal', {
        cvss_field: cvss_field.value,
        cvss_field_value: cvss_field_value.value,
        cvss_field_version: cvss_field_version.value,
        cvss_info: cvss_info.value
    });
}
</script>

<template>
    <!--------------------------------------------------------------------------->
    <!--                            Severities Section                         -->
    <!--------------------------------------------------------------------------->
    <section class="bg-white shadow-md rounded-lg p-6">
        <h2 class="font-black text-xl text-gray-800">
            <span class="text-primary text-3xl">S</span>everities
        </h2>
        <div class="cvss-details-wrapper flex flex-col gap-5">
            <!--------------------------------------------------------------------------->
            <!--                               CVSS 3.1 Info                           -->
            <!--------------------------------------------------------------------------->
            <div v-if="finding.severities.cvss_31" class="flex flex-col gap-2">
                <h3 class="font-black text-lg text-gray-700">CVSS 3.1</h3>
                <table class="cvss-table w-full border-collapse">
                    <tr>
                        <td class="font-medium text-gray-600">Score</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_31.base_score }}
                        </td>
                    </tr>
                    <tr>
                        <td class="font-medium text-gray-600">Exploitability</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_31.exploitability_score }}
                        </td>
                    </tr>
                    <tr>
                        <td class="font-medium text-gray-600">Impact</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_31.impact_score }}
                        </td>
                    </tr>
                    <tr
                        v-for="key in Object.keys(cvssV3FieldsMap)"
                        :key="key"
                        @click="
                            finding.severities.cvss_31[key] != null &&
                            openCVSSFieldValueDetailsModal(
                                key,
                                finding.severities.cvss_31[key][0],
                                '3'
                            )
                        "
                    >
                        <td>{{ props.cvssV3FieldsMap[key].full_name }}</td>
                        <td
                            v-if="finding.severities.cvss_31[key] != null"
                            :class="
                                props.cvssV3FieldsMap[key].class[finding.severities.cvss_31[key][0]]
                            "
                        >
                            {{
                                props.cvssV3FieldsMap[key].value_map[
                                    finding.severities.cvss_31[key][0]
                                ]
                            }}
                        </td>
                        <td v-if="finding.severities.cvss_31[key] == null">No Data</td>
                    </tr>
                </table>
                <div class="flex items-center gap-2">
                    <Icon
                        :icon="'material-symbols:help-outline'"
                        style="scale: 0.9; color: rgb(85, 85, 85)"
                    ></Icon>
                    <span class="text-sm text-gray-500 italic">
                        Click on the CVSS fields to get more information.</span
                    >
                </div>
            </div>

            <!--------------------------------------------------------------------------->
            <!--                               CVSS3 Info                              -->
            <!--------------------------------------------------------------------------->
            <div v-if="finding.severities.cvss_3" class="flex flex-col gap-2">
                <h3 class="font-black text-lg text-gray-700">CVSS 3</h3>
                <table class="cvss-table w-full border-collapse">
                    <tr>
                        <td class="font-medium text-gray-600">Score</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_3.base_score }}
                        </td>
                    </tr>
                    <tr>
                        <td class="font-medium text-gray-600">Exploitability</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_3.exploitability_score }}
                        </td>
                    </tr>
                    <tr>
                        <td class="font-medium text-gray-600">Impact</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_3.impact_score }}
                        </td>
                    </tr>
                    <tr
                        v-for="key in Object.keys(cvssV3FieldsMap)"
                        :key="key"
                        @click="
                            finding.severities.cvss_3[key] != null &&
                            openCVSSFieldValueDetailsModal(
                                key,
                                finding.severities.cvss_3[key][0],
                                '3'
                            )
                        "
                    >
                        <td>{{ cvssV3FieldsMap[key].full_name }}</td>
                        <td
                            v-if="finding.severities.cvss_3[key] != null"
                            :class="cvssV3FieldsMap[key].class[finding.severities.cvss_3[key][0]]"
                        >
                            {{ cvssV3FieldsMap[key].value_map[finding.severities.cvss_3[key][0]] }}
                        </td>
                        <td v-if="finding.severities.cvss_3[key] == null">No Data</td>
                    </tr>
                </table>
                <div class="flex flex-row gap-2">
                    <Icon
                        :icon="'material-symbols:help-outline'"
                        style="scale: 0.9; color: rgb(85, 85, 85)"
                    ></Icon>
                    <span class="text-sm text-gray-500 italic">
                        Click on the CVSS fields to get more information.</span
                    >
                </div>
            </div>

            <!--------------------------------------------------------------------------->
            <!--                               CVSS2 Info                              -->
            <!--------------------------------------------------------------------------->
            <div v-if="finding.severities.cvss_2" class="flex flex-col gap-2">
                <h3 class="font-black text-lg text-gray-700">CVSS 2</h3>
                <table class="cvss-table w-full border-collapse">
                    <tr>
                        <td class="font-medium text-gray-600">Score</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_2.base_score }}
                        </td>
                    </tr>
                    <tr>
                        <td class="font-medium text-gray-600">Exploitability</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_2.exploitability_score }}
                        </td>
                    </tr>
                    <tr>
                        <td class="font-medium text-gray-600">Impact</td>
                        <td class="text-gray-800">
                            {{ finding.severities.cvss_2.impact_score }}
                        </td>
                    </tr>
                    <tr
                        v-for="key in Object.keys(cvssV2FieldsMap)"
                        :key="key"
                        @click="
                            finding.severities.cvss_2[key] != null &&
                            openCVSSFieldValueDetailsModal(
                                key,
                                finding.severities.cvss_2[key][0],
                                '2'
                            )
                        "
                    >
                        <td>{{ cvssV2FieldsMap[key].full_name }}</td>
                        <td
                            v-if="finding.severities.cvss_2[key] != null"
                            :class="cvssV2FieldsMap[key].class[finding.severities.cvss_2[key][0]]"
                        >
                            {{ cvssV2FieldsMap[key].value_map[finding.severities.cvss_2[key][0]] }}
                        </td>
                        <td v-if="finding.severities.cvss_2[key] == null">No Data</td>
                    </tr>
                </table>
                <div class="flex flex-row gap-2">
                    <Icon
                        :icon="'material-symbols:help-outline'"
                        style="scale: 0.9; color: rgb(85, 85, 85)"
                    ></Icon>
                    <span class="text-sm text-gray-500 italic">
                        Click on the CVSS fields to get more information.</span
                    >
                </div>
            </div>

            <!--------------------------------------------------------------------------->
            <!--                               CVSS Graph                              -->
            <!--------------------------------------------------------------------------->
            <div class="cvss-graph-wrapper">
                <div v-if="chartVersion == 'cvss31' && cvssChartData && finding.severities.cvss_31">
                    <h3 class="font-black text-lg text-gray-700">CVSS 3.1 Graph</h3>
                    <div style="position: relative; width: 350px; height: 350px; margin-top: -30px">
                        <div style="position: absolute; margin-top: 10px">
                            <svg
                                height="350"
                                width="350"
                                style="margin-left: -25px; margin-top: -15px"
                            >
                                <line
                                    x1="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y1="220"
                                    x2="320"
                                    y2="305"
                                />
                                <line
                                    x1="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y1="220"
                                    y2="305"
                                    x2="30"
                                />
                                <line
                                    x1="175"
                                    x2="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y2="220"
                                    y1="50"
                                />
                            </svg>
                        </div>
                        <div
                            style="
                                position: absolute;
                                left: 43%;
                                top: 50px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_31.base_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                right: 35px;
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_31.impact_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                left: -15px;
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_31.exploitability_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                left: 70px;
                                top: 100px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                color: #464646;
                                transform: rotate(-60deg);
                            "
                        >
                            Base Score
                        </div>
                        <div
                            style="
                                position: absolute;
                                right: 125px;
                                top: 100px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                transform: rotate(60deg);
                                font-size: 0.9rem;
                                color: #8f8888;
                            "
                        >
                            (max 10.0)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                right: 80px;
                                font-weight: 500;
                                color: #464646;
                                font-family: roboto;
                            "
                        >
                            Impact
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 100px;
                                right: 55px;
                                font-weight: 500;
                                color: #8f8888;
                                font-family: roboto;
                                transform: rotate(60deg);
                                font-size: 0.9rem;
                            "
                        >
                            (max 6.0)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 90px;
                                left: -5px;
                                font-weight: 500;
                                color: #8f8888;
                                font-family: roboto;
                                transform: rotate(-60deg);
                                font-size: 0.9rem;
                            "
                        >
                            (max 3.9)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                left: 25px;
                                font-weight: 500;
                                color: #464646;
                            "
                        >
                            Exploitability
                        </div>
                        <div
                            style="
                                position: absolute;
                                height: 300px !important;
                                width: 300px !important;
                                margin-top: 10px;
                            "
                        >
                            <div style="margin-top: 3.5rem">
                                <Radar :data="cvssChartData" :options="getCVSSRadarChartConfig()" />
                            </div>
                        </div>
                    </div>
                </div>

                <div v-if="chartVersion == 'cvss3' && cvssChartData && finding.severities.cvss_3">
                    <h3 class="font-black text-lg text-gray-700">CVSS3 Graph</h3>
                    <div style="position: relative; width: 350px; height: 350px; margin-top: -30px">
                        <div style="position: absolute; margin-top: 10px">
                            <svg
                                height="350"
                                width="350"
                                style="margin-left: -25px; margin-top: -15px"
                            >
                                <line
                                    x1="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y1="220"
                                    x2="320"
                                    y2="305"
                                />
                                <line
                                    x1="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y1="220"
                                    y2="305"
                                    x2="30"
                                />
                                <line
                                    x1="175"
                                    x2="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y2="220"
                                    y1="50"
                                />
                            </svg>
                        </div>
                        <div
                            style="
                                position: absolute;
                                left: 43%;
                                top: 50px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_3.base_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                right: 35px;
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_3.impact_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                left: -15px;
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_3.exploitability_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                left: 70px;
                                top: 100px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                color: #464646;
                                transform: rotate(-60deg);
                            "
                        >
                            Base Score
                        </div>
                        <div
                            style="
                                position: absolute;
                                right: 125px;
                                top: 100px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                transform: rotate(60deg);
                                font-size: 0.9rem;
                                color: #8f8888;
                            "
                        >
                            (max 10.0)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                right: 80px;
                                font-weight: 500;
                                color: #464646;
                                font-family: roboto;
                            "
                        >
                            Impact
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 100px;
                                right: 55px;
                                font-weight: 500;
                                color: #8f8888;
                                font-family: roboto;
                                transform: rotate(60deg);
                                font-size: 0.9rem;
                            "
                        >
                            (max 6.0)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 90px;
                                left: -5px;
                                font-weight: 500;
                                color: #8f8888;
                                font-family: roboto;
                                transform: rotate(-60deg);
                                font-size: 0.9rem;
                            "
                        >
                            (max 3.9)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                left: 25px;
                                font-weight: 500;
                                color: #464646;
                            "
                        >
                            Exploitability
                        </div>
                        <div
                            style="
                                position: absolute;
                                height: 300px !important;
                                width: 300px !important;
                                margin-top: 10px;
                            "
                        >
                            <div style="margin-top: 3.5rem">
                                <Radar :data="cvssChartData" :options="getCVSSRadarChartConfig()" />
                            </div>
                        </div>
                    </div>
                </div>

                <div v-if="chartVersion == 'cvss2' && cvssChartData">
                    <h3 class="font-black text-lg text-gray-700">CVSS2 Graph</h3>
                    <div style="position: relative; width: 350px; height: 350px; margin-top: -30px">
                        <div style="position: absolute; margin-top: 10px">
                            <svg
                                height="350"
                                width="350"
                                style="margin-left: -25px; margin-top: -15px"
                            >
                                <line
                                    x1="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y1="220"
                                    x2="320"
                                    y2="305"
                                />
                                <line
                                    x1="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y1="220"
                                    y2="305"
                                    x2="30"
                                />
                                <line
                                    x1="175"
                                    x2="175"
                                    style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                    y2="220"
                                    y1="50"
                                />
                            </svg>
                        </div>
                        <div
                            style="
                                position: absolute;
                                left: 43%;
                                top: 50px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_2.base_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                right: 35px;
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_2.impact_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                left: -15px;
                                font-weight: 500;
                                color: #464646;
                                background-color: #fff;
                            "
                        >
                            <span
                                style="font-weight: 900; color: var(--accent)"
                                class="ng-binding"
                                >{{ finding.severities.cvss_2.exploitability_score }}</span
                            >
                        </div>
                        <div
                            style="
                                position: absolute;
                                left: 70px;
                                top: 100px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                color: #464646;
                                transform: rotate(-60deg);
                            "
                        >
                            Base Score
                        </div>
                        <div
                            style="
                                position: absolute;
                                right: 125px;
                                top: 100px;
                                transform: translate(-50%, -50%);
                                font-weight: 500;
                                transform: rotate(60deg);
                                font-size: 0.9rem;
                                color: #8f8888;
                            "
                        >
                            (max 10.0)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                right: 80px;
                                font-weight: 500;
                                color: #464646;
                                font-family: roboto;
                            "
                        >
                            Impact
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 100px;
                                right: 55px;
                                font-weight: 500;
                                color: #8f8888;
                                font-family: roboto;
                                transform: rotate(60deg);
                                font-size: 0.9rem;
                            "
                        >
                            (max 6.5)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 90px;
                                left: -5px;
                                font-weight: 500;
                                color: #8f8888;
                                font-family: roboto;
                                transform: rotate(-60deg);
                                font-size: 0.9rem;
                            "
                        >
                            (max 10.0)
                        </div>
                        <div
                            style="
                                position: absolute;
                                bottom: 35px;
                                left: 25px;
                                font-weight: 500;
                                color: #464646;
                            "
                        >
                            Exploitability
                        </div>
                        <div
                            style="
                                position: absolute;
                                height: 300px !important;
                                width: 300px !important;
                                margin-top: 10px;
                            "
                        >
                            <div style="margin-top: 3.5rem">
                                <Radar :data="cvssChartData" :options="getCVSSRadarChartConfig()" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--------------------------------------------------------------------------->
            <!--                             Impact Graph                              -->
            <!--------------------------------------------------------------------------->

            <div v-if="chartVersion == 'cvss31' && impactChartData && finding.severities.cvss_31">
                <h3 class="font-black text-lg text-gray-700">Impact</h3>
                <div style="position: relative; width: 350px; height: 350px; margin-top: -30px">
                    <div style="position: absolute; margin-top: 10px">
                        <svg height="350" width="350" style="margin-left: -25px; margin-top: -15px">
                            <line
                                x1="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y1="220"
                                x2="320"
                                y2="305"
                            />
                            <line
                                x1="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y1="220"
                                y2="305"
                                x2="30"
                            />
                            <line
                                x1="175"
                                x2="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y2="220"
                                y1="50"
                            />
                        </svg>
                    </div>
                    <div
                        style="
                            position: absolute;
                            left: 43%;
                            top: 50px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS3(
                                finding.severities.cvss_31.confidentiality_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            right: 35px;
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS3(
                                finding.severities.cvss_31.integrity_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            left: -15px;
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS3(
                                finding.severities.cvss_31.availability_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            left: 50px;
                            top: 110px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            color: #464646;
                            transform: rotate(-60deg);
                        "
                    >
                        Confidentiality
                    </div>
                    <div
                        style="
                            position: absolute;
                            right: 125px;
                            top: 100px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            transform: rotate(60deg);
                            font-size: 0.9rem;
                            color: #8f8888;
                        "
                    >
                        (max 0.56)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            right: 80px;
                            font-weight: 500;
                            color: #464646;
                            font-family: roboto;
                        "
                    >
                        Integrity
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 100px;
                            right: 50px;
                            font-weight: 500;
                            color: #8f8888;
                            font-family: roboto;
                            transform: rotate(60deg);
                            font-size: 0.9rem;
                        "
                    >
                        (max 0.56)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 90px;
                            left: -5px;
                            font-weight: 500;
                            color: #8f8888;
                            font-family: roboto;
                            transform: rotate(-60deg);
                            font-size: 0.9rem;
                        "
                    >
                        (max 0.56)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            left: 25px;
                            font-weight: 500;
                            color: #464646;
                        "
                    >
                        Availability
                    </div>
                    <div
                        style="
                            position: absolute;
                            height: 300px !important;
                            width: 300px !important;
                            margin-top: 10px;
                        "
                    >
                        <div style="margin-top: 3.5rem">
                            <Radar :data="impactChartData" :options="getImpactRadarChartConfig()" />
                        </div>
                    </div>
                </div>
            </div>

            <div
                v-else-if="chartVersion == 'cvss3' && impactChartData && finding.severities.cvss_3"
            >
                <h3 class="font-black text-lg text-gray-700">Impact</h3>
                <div style="position: relative; width: 350px; height: 350px; margin-top: -30px">
                    <div style="position: absolute; margin-top: 10px">
                        <svg height="350" width="350" style="margin-left: -25px; margin-top: -15px">
                            <line
                                x1="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y1="220"
                                x2="320"
                                y2="305"
                            />
                            <line
                                x1="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y1="220"
                                y2="305"
                                x2="30"
                            />
                            <line
                                x1="175"
                                x2="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y2="220"
                                y1="50"
                            />
                        </svg>
                    </div>
                    <div
                        style="
                            position: absolute;
                            left: 43%;
                            top: 50px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS3(
                                finding.severities.cvss_3.confidentiality_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            right: 35px;
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS3(
                                finding.severities.cvss_3.integrity_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            left: -15px;
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS3(
                                finding.severities.cvss_3.availability_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            left: 50px;
                            top: 110px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            color: #464646;
                            transform: rotate(-60deg);
                        "
                    >
                        Confidentiality
                    </div>
                    <div
                        style="
                            position: absolute;
                            right: 125px;
                            top: 100px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            transform: rotate(60deg);
                            font-size: 0.9rem;
                            color: #8f8888;
                        "
                    >
                        (max 0.56)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            right: 80px;
                            font-weight: 500;
                            color: #464646;
                            font-family: roboto;
                        "
                    >
                        Integrity
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 100px;
                            right: 50px;
                            font-weight: 500;
                            color: #8f8888;
                            font-family: roboto;
                            transform: rotate(60deg);
                            font-size: 0.9rem;
                        "
                    >
                        (max 0.56)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 90px;
                            left: -5px;
                            font-weight: 500;
                            color: #8f8888;
                            font-family: roboto;
                            transform: rotate(-60deg);
                            font-size: 0.9rem;
                        "
                    >
                        (max 0.56)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            left: 25px;
                            font-weight: 500;
                            color: #464646;
                        "
                    >
                        Availability
                    </div>
                    <div
                        style="
                            position: absolute;
                            height: 300px !important;
                            width: 300px !important;
                            margin-top: 10px;
                        "
                    >
                        <div style="margin-top: 3.5rem">
                            <Radar :data="impactChartData" :options="getImpactRadarChartConfig()" />
                        </div>
                    </div>
                </div>
            </div>

            <div v-else-if="chartVersion == 'cvss2' && impactChartData">
                <h3 class="font-black text-lg text-gray-700">Impact</h3>
                <div style="position: relative; width: 350px; height: 350px; margin-top: -30px">
                    <div style="position: absolute; margin-top: 10px">
                        <svg height="350" width="350" style="margin-left: -25px; margin-top: -15px">
                            <line
                                x1="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y1="220"
                                x2="320"
                                y2="305"
                            />
                            <line
                                x1="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y1="220"
                                y2="305"
                                x2="30"
                            />
                            <line
                                x1="175"
                                x2="175"
                                style="stroke: rgb(206, 206, 206); stroke-width: 2"
                                y2="220"
                                y1="50"
                            />
                        </svg>
                    </div>
                    <div
                        style="
                            position: absolute;
                            left: 43%;
                            top: 50px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS2(
                                finding.severities.cvss_2.confidentiality_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            right: 35px;
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS2(
                                finding.severities.cvss_2.integrity_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            left: -15px;
                            font-weight: 500;
                            color: #464646;
                            background-color: #fff;
                        "
                    >
                        <span style="font-weight: 900; color: var(--accent)" class="ng-binding">{{
                            getContinousFromDiscreteCVSS2(
                                finding.severities.cvss_2.availability_impact
                            )
                        }}</span>
                    </div>
                    <div
                        style="
                            position: absolute;
                            left: 50px;
                            top: 110px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            color: #464646;
                            transform: rotate(-60deg);
                        "
                    >
                        Confidentiality
                    </div>
                    <div
                        style="
                            position: absolute;
                            right: 125px;
                            top: 100px;
                            transform: translate(-50%, -50%);
                            font-weight: 500;
                            transform: rotate(60deg);
                            font-size: 0.9rem;
                            color: #8f8888;
                        "
                    >
                        (max 0.66)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            right: 80px;
                            font-weight: 500;
                            color: #464646;
                            font-family: roboto;
                        "
                    >
                        Integrity
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 100px;
                            right: 50px;
                            font-weight: 500;
                            color: #8f8888;
                            font-family: roboto;
                            transform: rotate(60deg);
                            font-size: 0.9rem;
                        "
                    >
                        (max 0.66)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 90px;
                            left: -5px;
                            font-weight: 500;
                            color: #8f8888;
                            font-family: roboto;
                            transform: rotate(-60deg);
                            font-size: 0.9rem;
                        "
                    >
                        (max 0.66)
                    </div>
                    <div
                        style="
                            position: absolute;
                            bottom: 35px;
                            left: 25px;
                            font-weight: 500;
                            color: #464646;
                        "
                    >
                        Availability
                    </div>
                    <div
                        style="
                            position: absolute;
                            height: 300px !important;
                            width: 300px !important;
                            margin-top: 10px;
                        "
                    >
                        <div style="margin-top: 3.5rem">
                            <Radar :data="impactChartData" :options="getImpactRadarChartConfig()" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</template>

<style scoped lang="scss">
@use '@/assets/colors.scss';
@use '@/assets/common/details.scss';
@use '@/assets/common/cvss.scss';
</style>
